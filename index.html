<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Para mi miamor üçÉ</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Satisfy&display=swap" rel="stylesheet" />
  <style>
    /* ===================== VARIABLES ===================== */
    :root {
      --sky: #a8d8ea;
      --sky-dark: #7ec8e3;
      --grass: #7ec850;
      --grass-dark: #5aaa2a;
      --soil: #c8884a;
      --sand: #f5e6c8;
      --cream: #fdf6e3;
      --white: #ffffff;
      --text-dark: #3d2b1f;
      --text-mid: #6b4c3b;
      --pink: #f7a8c4;
      --pink-dark: #e8729a;
      --pink-light: #fde8f0;
      --red: #e05c7a;
      --yellow: #ffe066;
      --yellow-dark: #f7c000;
      --leaf: #b8e986;
      --leaf-dark: #7ec850;
      --river: #5bbcd6;
      --brown: #9b6940;
      --dialog-bg: #fffbe8;
      --dialog-border: #c8884a;
      --dialog-text: #3d2b1f;
      --btn-yes: #7ec850;
      --btn-no: #e05c7a;
      --btn-yes-hover: #5aaa2a;
      --btn-no-hover: #c0395a;
      --star: #ffe066;
    }

    /* ===================== RESET & BASE ===================== */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Nunito', sans-serif;
      background: var(--sky);
      min-height: 100vh;
      overflow-x: hidden;
      cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'><text y='26' font-size='26'>üçÉ</text></svg>") 10 10, auto;
    }

    /* ===================== STARS / FLOATING ITEMS ===================== */
    .stars {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 0; overflow: hidden;
    }
    .star {
      position: absolute;
      font-size: 1.4rem;
      opacity: 0;
      animation: floatStar linear infinite;
    }
    @keyframes floatStar {
      0%   { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10%  { opacity: 0.7; }
      90%  { opacity: 0.7; }
      100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
    }

    /* ===================== INTRO SCREEN ===================== */
    #intro {
      position: fixed; inset: 0; z-index: 100;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      background: var(--sky);
      transition: opacity 0.8s ease, visibility 0.8s ease;
    }
    #intro.hidden { opacity: 0; visibility: hidden; }

    .intro-island {
      position: relative;
      display: flex; flex-direction: column; align-items: center;
      gap: 0;
    }

    /* Pixel-art style island using CSS */
    .island-base {
      width: 220px; height: 70px;
      background: radial-gradient(ellipse at 50% 30%, var(--grass) 60%, var(--grass-dark) 100%);
      border-radius: 50% 50% 40% 40%;
      position: relative;
      box-shadow: 0 8px 0 var(--soil), 0 16px 0 var(--brown);
    }
    .island-base::before {
      content: '';
      position: absolute; inset: 0;
      border-radius: inherit;
      background: repeating-linear-gradient(
        90deg,
        transparent 0px, transparent 10px,
        rgba(255,255,255,0.07) 10px, rgba(255,255,255,0.07) 11px
      );
    }

    /* Tom Nook SVG-like villager drawn in CSS */
    .villager {
      position: absolute;
      bottom: 60px; left: 50%; transform: translateX(-50%);
      display: flex; flex-direction: column; align-items: center;
      animation: bobVillager 1.4s ease-in-out infinite;
    }
    @keyframes bobVillager {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50%       { transform: translateX(-50%) translateY(-6px); }
    }

    /* Flowers on island */
    .flower {
      position: absolute;
      font-size: 1.4rem;
      animation: sway 2.5s ease-in-out infinite;
    }
    .flower:nth-child(1) { bottom: 54px; left: 18px; animation-delay: 0s; }
    .flower:nth-child(2) { bottom: 50px; left: 38px; animation-delay: 0.4s; }
    .flower:nth-child(3) { bottom: 54px; right: 18px; animation-delay: 0.8s; }
    .flower:nth-child(4) { bottom: 50px; right: 38px; animation-delay: 1.2s; }
    @keyframes sway {
      0%, 100% { transform: rotate(-5deg); }
      50%       { transform: rotate(5deg); }
    }

    /* Tree on island */
    .tree {
      position: absolute;
      bottom: 58px; left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
      animation: sway 3s ease-in-out infinite;
    }

    .intro-title {
      font-family: 'Satisfy', cursive;
      font-size: clamp(2rem, 6vw, 3.5rem);
      color: var(--red);
      text-shadow: 2px 3px 0 rgba(255,255,255,0.7), 0 0 20px rgba(240,80,120,0.3);
      margin-top: 32px;
      text-align: center;
      animation: fadeInUp 1s ease 0.5s both;
    }
    .intro-subtitle {
      font-size: 1rem;
      color: var(--text-mid);
      margin-top: 8px;
      text-align: center;
      animation: fadeInUp 1s ease 0.8s both;
    }
    .intro-btn {
      margin-top: 28px;
      padding: 14px 36px;
      font-family: 'Nunito', sans-serif;
      font-size: 1.1rem;
      font-weight: 800;
      color: white;
      background: var(--pink-dark);
      border: none; border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 5px 0 var(--red), 0 8px 20px rgba(240,80,120,0.35);
      transition: transform 0.1s, box-shadow 0.1s;
      animation: fadeInUp 1s ease 1.1s both, pulse 2s ease 2s infinite;
      letter-spacing: 0.5px;
    }
    .intro-btn:hover { transform: translateY(-2px); box-shadow: 0 7px 0 var(--red), 0 12px 24px rgba(240,80,120,0.4); }
    .intro-btn:active { transform: translateY(3px); box-shadow: 0 2px 0 var(--red); }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50%       { transform: scale(1.04); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* ===================== SCENE ===================== */
    #scene {
      position: relative;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-bottom: 80px;
      z-index: 1;
    }

    /* Sky gradient */
    .sky-bg {
      position: fixed; inset: 0; z-index: -2;
      background: linear-gradient(180deg, #c9e8f5 0%, #a8d8ea 40%, #d4f0c0 75%, #7ec850 100%);
    }

    /* Sun */
    .sun {
      position: fixed; top: 32px; right: 48px;
      width: 60px; height: 60px;
      background: radial-gradient(circle, #ffe066 60%, #f7c000 100%);
      border-radius: 50%;
      box-shadow: 0 0 40px 15px rgba(255,220,60,0.35);
      z-index: 0;
      animation: sunPulse 4s ease-in-out infinite;
    }
    @keyframes sunPulse {
      0%, 100% { box-shadow: 0 0 40px 15px rgba(255,220,60,0.35); }
      50%       { box-shadow: 0 0 60px 25px rgba(255,220,60,0.5); }
    }

    /* Clouds */
    .cloud {
      position: fixed;
      background: white;
      border-radius: 50px;
      opacity: 0.85;
      z-index: 0;
      animation: driftCloud linear infinite;
    }
    .cloud::before, .cloud::after {
      content: '';
      position: absolute;
      background: white;
      border-radius: 50%;
    }
    .cloud-1 { width: 110px; height: 36px; top: 60px; animation-duration: 28s; animation-delay: 0s; }
    .cloud-1::before { width: 50px; height: 50px; top: -25px; left: 18px; }
    .cloud-1::after  { width: 38px; height: 38px; top: -18px; left: 55px; }
    .cloud-2 { width: 80px; height: 26px; top: 110px; animation-duration: 36s; animation-delay: -12s; opacity: 0.65; }
    .cloud-2::before { width: 36px; height: 36px; top: -18px; left: 12px; }
    .cloud-2::after  { width: 28px; height: 28px; top: -12px; left: 40px; }
    .cloud-3 { width: 130px; height: 40px; top: 40px; animation-duration: 22s; animation-delay: -6s; }
    .cloud-3::before { width: 60px; height: 60px; top: -30px; left: 22px; }
    .cloud-3::after  { width: 44px; height: 44px; top: -22px; left: 68px; }

    @keyframes driftCloud {
      from { left: -200px; }
      to   { left: 110vw; }
    }

    /* Grass ground */
    .ground {
      position: fixed; bottom: 0; left: 0; right: 0;
      height: 120px; z-index: 0;
      background: linear-gradient(180deg, var(--grass) 0%, var(--grass-dark) 60%, var(--soil) 100%);
      border-radius: 60% 60% 0 0 / 20px 20px 0 0;
    }
    .ground::before {
      content: '';
      position: absolute; top: 0; left: 0; right: 0; height: 16px;
      background: repeating-linear-gradient(
        90deg,
        var(--grass-dark) 0px, var(--grass-dark) 12px,
        var(--grass) 12px, var(--grass) 24px
      );
      border-radius: inherit;
      opacity: 0.5;
    }

    /* ===================== DIALOG BOX ===================== */
    .dialog-container {
      position: relative;
      width: min(640px, 94vw);
      margin: 0 auto;
      z-index: 10;
    }

    .dialog-box {
      background: var(--dialog-bg);
      border: 4px solid var(--dialog-border);
      border-radius: 18px;
      padding: 20px 26px 18px;
      box-shadow: 0 6px 0 var(--brown), 0 12px 30px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.9);
      position: relative;
      min-height: 90px;
    }
    .dialog-box::before {
      content: '';
      position: absolute;
      top: -4px; left: -4px; right: -4px; bottom: -4px;
      border-radius: 20px;
      border: 2px solid rgba(255,255,255,0.5);
      pointer-events: none;
    }

    .dialog-speaker {
      display: inline-block;
      background: var(--dialog-border);
      color: white;
      font-weight: 800;
      font-size: 0.78rem;
      letter-spacing: 0.5px;
      padding: 3px 12px;
      border-radius: 20px;
      margin-bottom: 10px;
      text-transform: uppercase;
    }

    .dialog-text {
      font-size: clamp(0.95rem, 2.5vw, 1.08rem);
      color: var(--dialog-text);
      line-height: 1.65;
      font-weight: 600;
      min-height: 2.5em;
    }

    .dialog-cursor {
      display: inline-block;
      width: 10px; height: 10px;
      background: var(--dialog-border);
      border-radius: 2px;
      margin-left: 4px;
      vertical-align: middle;
      animation: blink 0.7s step-end infinite;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50%       { opacity: 0; }
    }

    /* Advance hint */
    .dialog-hint {
      position: absolute;
      bottom: 10px; right: 18px;
      font-size: 0.72rem;
      color: var(--text-mid);
      opacity: 0;
      transition: opacity 0.4s;
      display: flex; align-items: center; gap: 4px;
    }
    .dialog-hint.show { opacity: 1; }
    .dialog-hint span {
      display: inline-block;
      background: var(--dialog-border);
      color: white;
      border-radius: 4px;
      padding: 1px 6px;
      font-size: 0.65rem;
      font-weight: 800;
    }

    /* ===================== VILLAGER CHARACTER ===================== */
    .char-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: -4px;
      position: relative;
      z-index: 11;
    }

    /* Speech bubble arrow */
    .bubble-arrow {
      width: 0; height: 0;
      border-left: 14px solid transparent;
      border-right: 14px solid transparent;
      border-top: 14px solid var(--dialog-border);
      position: relative;
    }
    .bubble-arrow::after {
      content: '';
      position: absolute;
      top: -17px; left: -12px;
      width: 0; height: 0;
      border-left: 12px solid transparent;
      border-right: 12px solid transparent;
      border-top: 12px solid var(--dialog-bg);
    }

    /* Isabelle-like CSS character */
    .ac-character {
      animation: charBob 1.6s ease-in-out infinite;
      filter: drop-shadow(0 8px 12px rgba(0,0,0,0.18));
    }
    @keyframes charBob {
      0%, 100% { transform: translateY(0); }
      50%       { transform: translateY(-8px); }
    }

    /* ===================== PROGRESS DOTS ===================== */
    .progress-dots {
      display: flex; gap: 8px;
      justify-content: center;
      margin-top: 14px;
    }
    .dot {
      width: 10px; height: 10px;
      border-radius: 50%;
      background: rgba(200,136,74,0.3);
      transition: background 0.3s, transform 0.3s;
    }
    .dot.active { background: var(--dialog-border); transform: scale(1.3); }
    .dot.done   { background: var(--pink-dark); }

    /* ===================== YES / NO SECTION ===================== */
    #yn-section {
      display: none;
      flex-direction: column;
      align-items: center;
      margin-top: 28px;
      gap: 18px;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    #yn-section.visible {
      display: flex;
      opacity: 1;
      transform: translateY(0);
    }

    .yn-question {
      font-family: 'Satisfy', cursive;
      font-size: clamp(1.4rem, 4vw, 2rem);
      color: var(--red);
      text-align: center;
      text-shadow: 1px 2px 0 rgba(255,255,255,0.8);
    }

    .yn-buttons {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn-yn {
      padding: 14px 44px;
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 1.15rem;
      color: white;
      border: none; border-radius: 50px;
      cursor: pointer;
      position: relative;
      transition: transform 0.12s, box-shadow 0.12s;
      letter-spacing: 0.5px;
    }
    #btn-yes {
      background: var(--btn-yes);
      box-shadow: 0 5px 0 var(--grass-dark), 0 8px 20px rgba(90,170,42,0.35);
    }
    #btn-yes:hover { transform: translateY(-3px); box-shadow: 0 8px 0 var(--grass-dark), 0 14px 24px rgba(90,170,42,0.4); }
    #btn-yes:active { transform: translateY(3px); box-shadow: 0 2px 0 var(--grass-dark); }

    #btn-no {
      background: var(--btn-no);
      box-shadow: 0 5px 0 var(--btn-no-hover), 0 8px 20px rgba(224,92,122,0.35);
      transition: transform 0.12s, box-shadow 0.12s, left 0.15s, top 0.15s;
      position: relative;
    }
    #btn-no:hover { box-shadow: 0 5px 0 var(--btn-no-hover); }

    /* ===================== YES CELEBRATION ===================== */
    #celebration {
      display: none;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 20px;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.7s ease, transform 0.7s cubic-bezier(0.34,1.56,0.64,1);
    }
    #celebration.visible {
      display: flex; opacity: 1; transform: scale(1);
    }

    .celeb-emoji {
      font-size: 4rem;
      animation: celebSpin 0.8s cubic-bezier(0.34,1.56,0.64,1) both;
    }
    @keyframes celebSpin {
      from { transform: scale(0) rotate(-180deg); }
      to   { transform: scale(1) rotate(0deg); }
    }

    .celeb-title {
      font-family: 'Satisfy', cursive;
      font-size: clamp(1.8rem, 5vw, 2.8rem);
      color: var(--red);
      text-shadow: 2px 3px 0 rgba(255,255,255,0.8);
      line-height: 1.2;
    }

    .celeb-card {
      background: var(--dialog-bg);
      border: 4px solid var(--dialog-border);
      border-radius: 18px;
      padding: 22px 28px;
      max-width: 500px;
      box-shadow: 0 6px 0 var(--brown), 0 12px 30px rgba(0,0,0,0.12);
      font-size: 1rem;
      color: var(--dialog-text);
      line-height: 1.75;
      font-weight: 600;
    }
    .celeb-card .highlight {
      color: var(--red);
      font-weight: 800;
    }

    .gift-box {
      font-size: 3.5rem;
      animation: giftPulse 1.5s ease-in-out infinite;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,0.2));
    }
    @keyframes giftPulse {
      0%, 100% { transform: scale(1) rotate(-3deg); }
      50%       { transform: scale(1.1) rotate(3deg); }
    }

    .island-preview {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }
    .island-label {
      font-size: 0.82rem;
      font-weight: 800;
      color: var(--grass-dark);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .island-emojis {
      font-size: 2rem;
      display: flex; gap: 6px;
      animation: islandFloat 3s ease-in-out infinite;
    }
    @keyframes islandFloat {
      0%, 100% { transform: translateY(0); }
      50%       { transform: translateY(-6px); }
    }

    /* ===================== CONFETTI ===================== */
    .confetti-piece {
      position: fixed;
      width: 10px; height: 10px;
      border-radius: 2px;
      opacity: 0;
      animation: confettiFall linear forwards;
      z-index: 200;
      pointer-events: none;
    }
    @keyframes confettiFall {
      0%   { transform: translateY(-20px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(105vh) rotate(720deg); opacity: 0.2; }
    }

    /* ===================== HEART RAIN ===================== */
    .heart-float {
      position: fixed;
      font-size: 1.5rem;
      opacity: 0;
      animation: heartRise linear forwards;
      pointer-events: none;
      z-index: 200;
    }
    @keyframes heartRise {
      0%   { transform: translateY(0) scale(0.5); opacity: 1; }
      100% { transform: translateY(-90vh) scale(1.2); opacity: 0; }
    }

    /* ===================== SECTIONS CONTAINER ===================== */
    #main-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0;
      padding-top: clamp(30px, 6vh, 60px);
      width: 100%;
      max-width: 700px;
      padding-left: 16px;
      padding-right: 16px;
    }

    /* ===================== SECTION TRANSITIONS ===================== */
    .scene-section {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .scene-section.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* ===================== AUDIO NOTE ===================== */
    .audio-note {
      position: fixed;
      bottom: 20px; right: 20px;
      background: rgba(255,255,255,0.85);
      backdrop-filter: blur(8px);
      border: 2px solid var(--dialog-border);
      border-radius: 50px;
      padding: 8px 16px;
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--text-mid);
      z-index: 50;
      display: flex; align-items: center; gap: 6px;
      cursor: pointer;
      transition: transform 0.15s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
    }
    .audio-note:hover { transform: scale(1.05); }
    .audio-note-icon { font-size: 1rem; }

    /* ===================== LEAF PARTICLES ===================== */
    .leaf-particle {
      position: fixed;
      font-size: 1.2rem;
      opacity: 0;
      pointer-events: none;
      z-index: 0;
      animation: leafDrift linear infinite;
    }
    @keyframes leafDrift {
      0%   { transform: translate(0, -10px) rotate(0deg); opacity: 0; }
      10%  { opacity: 0.7; }
      90%  { opacity: 0.5; }
      100% { transform: translate(60px, 105vh) rotate(360deg); opacity: 0; }
    }

    /* ===================== NO BUTTON ESCAPE ===================== */
    #no-tooltip {
      position: fixed;
      background: var(--dialog-bg);
      border: 3px solid var(--dialog-border);
      border-radius: 12px;
      padding: 8px 16px;
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--text-mid);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 300;
      max-width: 200px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    #no-tooltip.show { opacity: 1; }

    /* ===================== RESPONSIVE ===================== */
    @media (max-width: 480px) {
      .dialog-box { padding: 16px 16px 18px; }
      .yn-buttons { flex-direction: column; align-items: center; }
      .btn-yn { width: 200px; text-align: center; }
    }
  </style>
</head>
<body>

<!-- Floating stars background -->
<div class="stars" id="stars"></div>

<!-- INTRO SCREEN -->
<div id="intro">
  <div class="intro-island">
    <!-- Flowers -->
    <span class="flower">üå∏</span>
    <span class="flower">üíê</span>
    <span class="flower">üå∫</span>
    <span class="flower">üå∑</span>

    <!-- Tree -->
    <span class="tree">üåø</span>

    <!-- Cat villager on island -->
    <div class="villager">
      <svg width="80" height="96" viewBox="0 0 80 96" fill="none" xmlns="http://www.w3.org/2000/svg">
        <!-- Body -->
        <ellipse cx="40" cy="74" rx="22" ry="17" fill="#fde8c8"/>
        <!-- Shirt / tummy -->
        <ellipse cx="40" cy="74" rx="16" ry="12" fill="#f7a8c4"/>
        <ellipse cx="40" cy="76" rx="10" ry="8" fill="#fdf0e0" opacity="0.8"/>
        <!-- Arms -->
        <ellipse cx="18" cy="72" rx="8" ry="5" fill="#fde8c8" transform="rotate(-25 18 72)"/>
        <ellipse cx="62" cy="72" rx="8" ry="5" fill="#fde8c8" transform="rotate(25 62 72)"/>
        <!-- Paws on arms -->
        <ellipse cx="12" cy="76" rx="6" ry="5" fill="#fde8c8"/>
        <ellipse cx="68" cy="76" rx="6" ry="5" fill="#fde8c8"/>
        <!-- Legs -->
        <rect x="26" y="87" width="11" height="13" rx="5" fill="#fde8c8"/>
        <rect x="43" y="87" width="11" height="13" rx="5" fill="#fde8c8"/>
        <!-- Paws -->
        <ellipse cx="31" cy="99" rx="8" ry="4.5" fill="#f2c8a0"/>
        <ellipse cx="49" cy="99" rx="8" ry="4.5" fill="#f2c8a0"/>
        <!-- Tail -->
        <path d="M 62 85 Q 78 75 74 60 Q 70 48 62 52" stroke="#fde8c8" stroke-width="6" fill="none" stroke-linecap="round"/>
        <!-- Neck -->
        <ellipse cx="40" cy="60" rx="13" ry="8" fill="#fde8c8"/>
        <!-- Head -->
        <ellipse cx="40" cy="36" rx="24" ry="23" fill="#fde8c8"/>
        <!-- Cat ears -->
        <polygon points="16,18 10,2 26,14" fill="#fde8c8"/>
        <polygon points="18,17 13,5 25,13" fill="#f7a8c4" opacity="0.7"/>
        <polygon points="64,18 70,2 54,14" fill="#fde8c8"/>
        <polygon points="62,17 67,5 55,13" fill="#f7a8c4" opacity="0.7"/>
        <!-- Forehead stripe -->
        <path d="M 36 16 Q 40 12 44 16" stroke="#e8b88a" stroke-width="1.5" fill="none" stroke-linecap="round" opacity="0.6"/>
        <!-- Eyes closed happy -->
        <path d="M 28 36 Q 31 32 34 36" stroke="#3d2b1f" stroke-width="2.2" fill="none" stroke-linecap="round"/>
        <path d="M 46 36 Q 49 32 52 36" stroke="#3d2b1f" stroke-width="2.2" fill="none" stroke-linecap="round"/>
        <!-- Eye shine dots -->
        <circle cx="30" cy="34" r="1" fill="#c8884a" opacity="0.5"/>
        <circle cx="50" cy="34" r="1" fill="#c8884a" opacity="0.5"/>
        <!-- Nose -->
        <ellipse cx="40" cy="42" rx="3" ry="2" fill="#f7a8c4"/>
        <!-- Mouth -->
        <path d="M 37 44 Q 40 48 43 44" stroke="#c8884a" stroke-width="1.8" fill="none" stroke-linecap="round"/>
        <!-- Whiskers left -->
        <line x1="16" y1="40" x2="34" y2="42" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
        <line x1="16" y1="44" x2="34" y2="43" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
        <line x1="18" y1="48" x2="34" y2="44" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
        <!-- Whiskers right -->
        <line x1="64" y1="40" x2="46" y2="42" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
        <line x1="64" y1="44" x2="46" y2="43" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
        <line x1="62" y1="48" x2="46" y2="44" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
        <!-- Blush -->
        <ellipse cx="22" cy="46" rx="6" ry="3.5" fill="#f7a8c4" opacity="0.55"/>
        <ellipse cx="58" cy="46" rx="6" ry="3.5" fill="#f7a8c4" opacity="0.55"/>
        <!-- Little bow on head -->
        <ellipse cx="28" cy="16" rx="7" ry="5" fill="#e05c7a" opacity="0.85"/>
        <ellipse cx="40" cy="16" rx="7" ry="5" fill="#e05c7a" opacity="0.85"/>
        <circle cx="34" cy="16" r="4" fill="#f7a8c4"/>
      </svg>
    </div>

    <div class="island-base"></div>
  </div>

  <h1 class="intro-title">Para mi miamor üçÉ</h1>
  <p class="intro-subtitle">de tu villager favorito üíå</p>
  <button class="intro-btn" onclick="startExperience()">Tocar para abrir ‚úâÔ∏è</button>
</div>

<!-- SCENE BACKGROUND -->
<div class="sky-bg"></div>
<div class="sun"></div>
<div class="cloud cloud-1"></div>
<div class="cloud cloud-2"></div>
<div class="cloud cloud-3"></div>
<div class="ground"></div>

<!-- NO tooltip -->
<div id="no-tooltip">¬°Ese bot√≥n no funciona! üôà</div>

<!-- MAIN CONTENT -->
<div id="scene">
  <div id="main-content">

    <!-- DIALOG SECTION -->
    <div class="scene-section" id="dialog-section">

      <!-- Cat character in dialog scene -->
      <div class="char-wrapper">
        <svg class="ac-character" width="88" height="106" viewBox="0 0 80 96" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Body -->
          <ellipse cx="40" cy="74" rx="22" ry="17" fill="#fde8c8"/>
          <ellipse cx="40" cy="74" rx="16" ry="12" fill="#f7a8c4"/>
          <ellipse cx="40" cy="76" rx="10" ry="8" fill="#fdf0e0" opacity="0.8"/>
          <!-- Arms -->
          <ellipse cx="18" cy="72" rx="8" ry="5" fill="#fde8c8" transform="rotate(-25 18 72)"/>
          <ellipse cx="62" cy="72" rx="8" ry="5" fill="#fde8c8" transform="rotate(25 62 72)"/>
          <ellipse cx="12" cy="76" rx="6" ry="5" fill="#fde8c8"/>
          <ellipse cx="68" cy="76" rx="6" ry="5" fill="#fde8c8"/>
          <!-- Legs -->
          <rect x="26" y="87" width="11" height="13" rx="5" fill="#fde8c8"/>
          <rect x="43" y="87" width="11" height="13" rx="5" fill="#fde8c8"/>
          <ellipse cx="31" cy="99" rx="8" ry="4.5" fill="#f2c8a0"/>
          <ellipse cx="49" cy="99" rx="8" ry="4.5" fill="#f2c8a0"/>
          <!-- Tail -->
          <path d="M 62 85 Q 78 75 74 60 Q 70 48 62 52" stroke="#fde8c8" stroke-width="6" fill="none" stroke-linecap="round"/>
          <!-- Neck -->
          <ellipse cx="40" cy="60" rx="13" ry="8" fill="#fde8c8"/>
          <!-- Head -->
          <ellipse cx="40" cy="36" rx="24" ry="23" fill="#fde8c8"/>
          <!-- Cat ears -->
          <polygon points="16,18 10,2 26,14" fill="#fde8c8"/>
          <polygon points="18,17 13,5 25,13" fill="#f7a8c4" opacity="0.7"/>
          <polygon points="64,18 70,2 54,14" fill="#fde8c8"/>
          <polygon points="62,17 67,5 55,13" fill="#f7a8c4" opacity="0.7"/>
          <!-- Forehead stripe -->
          <path d="M 36 16 Q 40 12 44 16" stroke="#e8b88a" stroke-width="1.5" fill="none" stroke-linecap="round" opacity="0.6"/>
          <!-- Eyes -->
          <path d="M 28 36 Q 31 32 34 36" stroke="#3d2b1f" stroke-width="2.2" fill="none" stroke-linecap="round"/>
          <path d="M 46 36 Q 49 32 52 36" stroke="#3d2b1f" stroke-width="2.2" fill="none" stroke-linecap="round"/>
          <circle cx="30" cy="34" r="1" fill="#c8884a" opacity="0.5"/>
          <circle cx="50" cy="34" r="1" fill="#c8884a" opacity="0.5"/>
          <!-- Nose -->
          <ellipse cx="40" cy="42" rx="3" ry="2" fill="#f7a8c4"/>
          <!-- Mouth -->
          <path d="M 37 44 Q 40 48 43 44" stroke="#c8884a" stroke-width="1.8" fill="none" stroke-linecap="round"/>
          <!-- Whiskers left -->
          <line x1="16" y1="40" x2="34" y2="42" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
          <line x1="16" y1="44" x2="34" y2="43" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
          <line x1="18" y1="48" x2="34" y2="44" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
          <!-- Whiskers right -->
          <line x1="64" y1="40" x2="46" y2="42" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
          <line x1="64" y1="44" x2="46" y2="43" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
          <line x1="62" y1="48" x2="46" y2="44" stroke="#c8884a" stroke-width="1.2" opacity="0.6"/>
          <!-- Blush -->
          <ellipse cx="22" cy="46" rx="6" ry="3.5" fill="#f7a8c4" opacity="0.55"/>
          <ellipse cx="58" cy="46" rx="6" ry="3.5" fill="#f7a8c4" opacity="0.55"/>
          <!-- Bow -->
          <ellipse cx="28" cy="16" rx="7" ry="5" fill="#e05c7a" opacity="0.85"/>
          <ellipse cx="40" cy="16" rx="7" ry="5" fill="#e05c7a" opacity="0.85"/>
          <circle cx="34" cy="16" r="4" fill="#f7a8c4"/>
        </svg>
        <div class="bubble-arrow"></div>
      </div>

      <!-- Dialog box -->
      <div class="dialog-container">
        <div class="dialog-box" id="dialog-box" onclick="advanceDialog()">
          <div class="dialog-speaker" id="dialog-speaker">Isabelle</div>
          <div class="dialog-text" id="dialog-text"></div>
          <span class="dialog-cursor" id="dialog-cursor" style="display:none"></span>
          <div class="dialog-hint" id="dialog-hint">
            Toca para continuar <span>‚ñº</span>
          </div>
        </div>
      </div>

      <!-- Progress dots -->
      <div class="progress-dots" id="progress-dots"></div>

    </div>

    <!-- YES / NO SECTION -->
    <div id="yn-section">
      <p class="yn-question">¬øQuieres ser mi San Valent√≠n? üíï</p>
      <div class="yn-buttons">
        <button class="btn-yn" id="btn-yes" onclick="onYes()">üíö ¬°S√≠!</button>
        <button class="btn-yn" id="btn-no" onmouseover="escapeNo(event)" ontouchstart="escapeNo(event)">üíî No...</button>
      </div>
    </div>

    <!-- CELEBRATION -->
    <div id="celebration">
      <div class="celeb-emoji">üéâ</div>
      <h2 class="celeb-title">¬°Yay, mi miamor! üå∏</h2>
      <div class="celeb-card">
        <p>
          Hoy quiero que sepas que vivir lejos no hace que te extra√±e menos,
          sino que cada momento juntos valga m√°s. üåø
        </p>
        <br/>
        <p>
          Y para que construyamos algo juntos sin importar la distancia...
          tengo un regalo muy especial para ti:
        </p>
      </div>
      <div class="gift-box">üéÅ</div>
      <div class="celeb-card" style="background: linear-gradient(135deg, #fde8f0, #d4f0c0);">
        <p style="text-align:center; font-size:1.15rem;">
          üèùÔ∏è <span class="highlight">Animal Crossing: New Horizons</span> üèùÔ∏è
        </p>
        <br/>
        <p style="text-align:center;">
          Para que armemos <span class="highlight">nuestra isla</span> juntos,
          aunque estemos lejos. Tu Switch OLED y la m√≠a van a ser nuestro lugar secreto. üåäüçÉ
        </p>
      </div>
      <div class="island-preview">
        <div class="island-label">Nuestra futura isla üó∫Ô∏è</div>
        <div class="island-emojis">üå¥ üèñÔ∏è üå∏ ü¶ã üåø üçÑ ‚≠ê</div>
      </div>
      <p style="font-family:'Satisfy',cursive; font-size:1.4rem; color:var(--red); text-align:center; margin-top:8px; text-shadow: 1px 2px 0 rgba(255,255,255,0.8);">
        Feliz San Valent√≠n, mi miamor üíï
      </p>
    </div>

  </div>
</div>

<!-- Audio note -->
<div class="audio-note" id="audio-note" onclick="toggleMusic()">
  <span class="audio-note-icon">üéµ</span>
  <span id="audio-label">M√∫sica de fondo</span>
</div>

<script>
  // ===================== DATA =====================
  const dialogs = [
    {
      speaker: "Mimi üê±",
      text: "¬°Oh, Danna! ¬°Qu√© bueno que est√°s aqu√≠! Ten√≠a que darte un mensaje muy importante... üì¨"
    },
    {
      speaker: "Mimi üê±",
      text: "Alguien muy especial me pidi√≥ que te lo entregara. Dice que eres... ¬°su mi amor! ü•π"
    },
    {
      speaker: "Mimi üê±",
      text: "Me dijo que aunque la distancia los separa, piensa en ti todos los d√≠as. Y que cada momento juntos vale much√≠simo. üíå"
    },
    {
      speaker: "Mimi üê±",
      text: "Tambi√©n me dijo que tiene algo muy especial planeado para hoy... üèùÔ∏è"
    },
    {
      speaker: "Mimi üê±",
      text: "¬°Y tiene que ver con construir algo juntos! Algo que los una sin importar cu√°ntos kil√≥metros los separen. üåä"
    },
    {
      speaker: "Mimi üê±",
      text: "¬°Pero primero tiene una pregunta muy importante para ti, Danna! üíï"
    }
  ];

  // ===================== STATE =====================
  let currentDialog = 0;
  let typing = false;
  let typeInterval = null;
  let fullText = '';
  let displayedText = '';
  let musicPlaying = false;
  let noEscapeCount = 0;
  const noMessages = [
    "¬°Ese bot√≥n no funciona! üôà",
    "Nope, int√©ntalo de nuevo üèÉ",
    "¬°Ni lo sue√±es! üí®",
    "¬°Ese bot√≥n est√° roto! üòá",
    "¬°Ya sabes cu√°l es la respuesta correcta! üíö"
  ];

  // ===================== STARS =====================
  function createStars() {
    const container = document.getElementById('stars');
    const items = ['üå∏','‚ú®','üíï','üçÉ','‚≠ê','üåø','üí´','üå∑','üå∫'];
    for (let i = 0; i < 18; i++) {
      const el = document.createElement('div');
      el.className = 'star';
      el.textContent = items[Math.floor(Math.random() * items.length)];
      el.style.left = Math.random() * 100 + 'vw';
      el.style.fontSize = (0.9 + Math.random() * 1.2) + 'rem';
      el.style.animationDuration = (8 + Math.random() * 18) + 's';
      el.style.animationDelay = (Math.random() * 15) + 's';
      container.appendChild(el);
    }
  }

  function createLeaves() {
    const items = ['üçÉ','üçÇ','üåø'];
    for (let i = 0; i < 8; i++) {
      const el = document.createElement('div');
      el.className = 'leaf-particle';
      el.textContent = items[Math.floor(Math.random() * items.length)];
      el.style.left = Math.random() * 100 + 'vw';
      el.style.animationDuration = (10 + Math.random() * 16) + 's';
      el.style.animationDelay = (Math.random() * 20) + 's';
      document.body.appendChild(el);
    }
  }

  // ===================== INTRO =====================
  function startExperience() {
    const intro = document.getElementById('intro');
    intro.classList.add('hidden');
    setTimeout(() => {
      intro.style.display = 'none';
      showDialogSection();
    }, 800);
  }

  // ===================== DIALOG =====================
  function buildDots() {
    const container = document.getElementById('progress-dots');
    container.innerHTML = '';
    for (let i = 0; i < dialogs.length; i++) {
      const d = document.createElement('div');
      d.className = 'dot' + (i === 0 ? ' active' : '');
      d.id = 'dot-' + i;
      container.appendChild(d);
    }
  }

  function updateDots(idx) {
    for (let i = 0; i < dialogs.length; i++) {
      const d = document.getElementById('dot-' + i);
      if (!d) continue;
      d.className = 'dot' + (i < idx ? ' done' : '') + (i === idx ? ' active' : '');
    }
  }

  function showDialogSection() {
    const section = document.getElementById('dialog-section');
    section.classList.add('visible');
    buildDots();
    setTimeout(() => showDialog(0), 400);
  }

  function showDialog(idx) {
    if (idx >= dialogs.length) {
      showYN();
      return;
    }
    currentDialog = idx;
    const data = dialogs[idx];
    document.getElementById('dialog-speaker').textContent = data.speaker;
    document.getElementById('dialog-hint').classList.remove('show');
    document.getElementById('dialog-cursor').style.display = 'none';

    updateDots(idx);
    typeText(data.text, () => {
      document.getElementById('dialog-cursor').style.display = 'inline-block';
      if (idx < dialogs.length - 1) {
        document.getElementById('dialog-hint').classList.add('show');
      }
    });
  }

  // ===================== AC VOICE SYSTEM =====================
  // Replicates the Animal Crossing "Animalese" effect:
  // each visible letter triggers a short sine burst at a pitch
  // derived from the char code, with a bandpass filter for that
  // cute muffled timbre. Identical logic to the original game.
  let voiceCtx = null;

  function ensureVoiceCtx() {
    if (!voiceCtx) voiceCtx = new (window.AudioContext || window.webkitAudioContext)();
    if (voiceCtx.state === 'suspended') voiceCtx.resume();
  }

  const VOICE_BASE  = 680;   // base Hz ‚Äî higher = cuter/cat-like
  const VOICE_RANGE = 220;   // spread across the scale
  const VOICE_DUR   = 0.072; // phoneme length in seconds

  function playLetter(char) {
    if (!voiceCtx) return;
    if (/\s/.test(char)) return;
    const code = char.codePointAt(0);
    if (code > 0xFFFF) return; // skip emoji surrogates

    const normalized = (code % 26) / 26;
    const jitter     = (Math.random() - 0.5) * 0.08;
    const freq       = VOICE_BASE + (normalized + jitter) * VOICE_RANGE;

    const osc    = voiceCtx.createOscillator();
    const filter = voiceCtx.createBiquadFilter();
    const gain   = voiceCtx.createGain();

    filter.type = 'bandpass';
    filter.frequency.value = freq * 1.8;
    filter.Q.value = 3.5;

    osc.connect(filter);
    filter.connect(gain);
    gain.connect(voiceCtx.destination);

    osc.type = 'sine';
    osc.frequency.setValueAtTime(freq, voiceCtx.currentTime);

    const now = voiceCtx.currentTime;
    gain.gain.setValueAtTime(0, now);
    gain.gain.linearRampToValueAtTime(0.28, now + 0.008);
    gain.gain.setValueAtTime(0.28, now + VOICE_DUR * 0.55);
    gain.gain.exponentialRampToValueAtTime(0.001, now + VOICE_DUR);

    osc.start(now);
    osc.stop(now + VOICE_DUR + 0.01);
  }

  function typeText(text, onDone) {
    ensureVoiceCtx();
    const el = document.getElementById('dialog-text');
    const cursor = document.getElementById('dialog-cursor');
    el.textContent = '';
    cursor.style.display = 'none';
    fullText = text;
    displayedText = '';
    typing = true;
    let i = 0;
    let soundToggle = false;
    clearInterval(typeInterval);
    typeInterval = setInterval(() => {
      const ch = text[i];
      displayedText += ch;
      el.textContent = displayedText;
      // Play every other non-space character to avoid overloading audio
      soundToggle = !soundToggle;
      if (soundToggle && !/\s/.test(ch)) playLetter(ch);
      i++;
      if (i >= text.length) {
        clearInterval(typeInterval);
        typing = false;
        if (onDone) onDone();
      }
    }, 42);
  }

  function advanceDialog() {
    if (typing) {
      // Skip typing
      clearInterval(typeInterval);
      typing = false;
      document.getElementById('dialog-text').textContent = fullText;
      document.getElementById('dialog-cursor').style.display = 'inline-block';
      if (currentDialog < dialogs.length - 1) {
        document.getElementById('dialog-hint').classList.add('show');
      }
      return;
    }
    const next = currentDialog + 1;
    if (next < dialogs.length) {
      showDialog(next);
    } else {
      showYN();
    }
  }

  // ===================== YES / NO =====================
  function showYN() {
    const section = document.getElementById('dialog-section');
    section.style.opacity = '0';
    section.style.transform = 'translateY(-20px)';
    section.style.transition = 'opacity 0.5s, transform 0.5s';

    setTimeout(() => {
      section.style.display = 'none';
      const yn = document.getElementById('yn-section');
      yn.style.display = 'flex';
      requestAnimationFrame(() => {
        requestAnimationFrame(() => yn.classList.add('visible'));
      });
    }, 500);
  }

  function onYes() {
    document.getElementById('yn-section').style.display = 'none';
    const celeb = document.getElementById('celebration');
    celeb.style.display = 'flex';
    requestAnimationFrame(() => {
      requestAnimationFrame(() => celeb.classList.add('visible'));
    });
    shootConfetti();
    shootHearts();
    setTimeout(shootHearts, 1200);
    setTimeout(shootHearts, 2400);
  }

  function escapeNo(e) {
    const btn = document.getElementById('btn-no');
    const tooltip = document.getElementById('no-tooltip');
    const msg = noMessages[noEscapeCount % noMessages.length];
    noEscapeCount++;

    // Move button to random position
    const maxX = window.innerWidth - 120;
    const maxY = window.innerHeight - 80;
    const newX = Math.random() * maxX;
    const newY = Math.random() * maxY;
    btn.style.position = 'fixed';
    btn.style.left = newX + 'px';
    btn.style.top = newY + 'px';
    btn.style.zIndex = '500';

    // Show tooltip near old position
    tooltip.textContent = msg;
    tooltip.classList.add('show');
    tooltip.style.left = (e.clientX || newX) + 'px';
    tooltip.style.top = (e.clientY || newY) - 50 + 'px';
    setTimeout(() => tooltip.classList.remove('show'), 1800);
  }

  // ===================== CONFETTI =====================
  function shootConfetti() {
    const colors = ['#f7a8c4','#7ec850','#ffe066','#5bbcd6','#e05c7a','#f9c864','#b8e986'];
    for (let i = 0; i < 80; i++) {
      setTimeout(() => {
        const el = document.createElement('div');
        el.className = 'confetti-piece';
        el.style.background = colors[Math.floor(Math.random() * colors.length)];
        el.style.left = Math.random() * 100 + 'vw';
        el.style.top = '-10px';
        el.style.width = (6 + Math.random() * 8) + 'px';
        el.style.height = (6 + Math.random() * 8) + 'px';
        el.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
        el.style.animationDuration = (1.5 + Math.random() * 2.5) + 's';
        el.style.animationDelay = '0s';
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 4000);
      }, i * 30);
    }
  }

  function shootHearts() {
    const hearts = ['üíï','üíó','üíì','üíñ','üíù','ü©∑','‚ù§Ô∏è','üíû'];
    for (let i = 0; i < 14; i++) {
      setTimeout(() => {
        const el = document.createElement('div');
        el.className = 'heart-float';
        el.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        el.style.left = (5 + Math.random() * 90) + 'vw';
        el.style.bottom = '0';
        el.style.fontSize = (1 + Math.random() * 1.5) + 'rem';
        el.style.animationDuration = (2 + Math.random() * 2) + 's';
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 4000);
      }, i * 120);
    }
  }

  // ===================== MUSIC (Web Audio API - AC-style jingle) =====================
  let audioCtx = null;
  let musicNodes = [];
  let musicScheduled = false;
  
  function toggleMusic() {
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    if (musicPlaying) {
      stopMusic();
    } else {
      startMusic();
    }
  }

  // Simple AC-inspired melody using Web Audio
  const melody = [
    // Notes: [freq, duration, delay]
    [523.25, 0.18, 0],    // C5
    [587.33, 0.18, 0.2],  // D5
    [659.25, 0.18, 0.4],  // E5
    [783.99, 0.36, 0.6],  // G5
    [659.25, 0.18, 1.0],  // E5
    [587.33, 0.18, 1.2],  // D5
    [523.25, 0.36, 1.4],  // C5
    [392.00, 0.18, 1.8],  // G4
    [440.00, 0.18, 2.0],  // A4
    [523.25, 0.18, 2.2],  // C5
    [659.25, 0.36, 2.4],  // E5
    [587.33, 0.18, 2.8],  // D5
    [523.25, 0.36, 3.0],  // C5
    [440.00, 0.18, 3.4],  // A4
    [392.00, 0.54, 3.6],  // G4
  ];
  const loopDuration = 4.2;
  let loopTimeout = null;

  function playNote(freq, start, dur) {
    if (!audioCtx) return;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.type = 'triangle';
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime + start);
    gain.gain.setValueAtTime(0, audioCtx.currentTime + start);
    gain.gain.linearRampToValueAtTime(0.18, audioCtx.currentTime + start + 0.02);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + start + dur);
    osc.start(audioCtx.currentTime + start);
    osc.stop(audioCtx.currentTime + start + dur + 0.05);
    musicNodes.push(osc);
  }

  function playMelodyOnce() {
    if (!musicPlaying) return;
    melody.forEach(([freq, dur, delay]) => playNote(freq, delay, dur));
    loopTimeout = setTimeout(playMelodyOnce, loopDuration * 1000);
  }

  function startMusic() {
    musicPlaying = true;
    document.getElementById('audio-label').textContent = 'üéµ Pausar';
    if (audioCtx.state === 'suspended') audioCtx.resume();
    playMelodyOnce();
  }

  function stopMusic() {
    musicPlaying = false;
    clearTimeout(loopTimeout);
    musicNodes.forEach(n => { try { n.stop(); } catch(e){} });
    musicNodes = [];
    document.getElementById('audio-label').textContent = 'M√∫sica de fondo';
  }

  // ===================== INIT =====================
  createStars();
  createLeaves();
</script>
</body>
</html>